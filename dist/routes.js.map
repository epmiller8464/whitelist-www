{"version":3,"sources":["../routes.js"],"names":["cors","require","csurf","authenticate","passport","module","exports","app","disable","use","set","marketing","cookie","req","res","next","locals","_csrfToken","csrfToken","index","tokensale","err","Error","status","message","error","get","render"],"mappings":"AAAA;;AACA,IAAMA,OAAOC,QAAQ,MAAR,CAAb;AACA,IAAMC,QAAQD,QAAQ,OAAR,CAAd;AACA,IAAME,eAAeF,QAAQ,oBAAR,CAArB;AACA,IAAMG,WAAWH,QAAQ,UAAR,CAAjB;AACAI,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EAAe;;AAE9BA,MAAIC,OAAJ,CAAY,cAAZ;AACAD,MAAIE,GAAJ,CAAQT,MAAR;AACAO,MAAIG,GAAJ,CAAQ,aAAR,EAAuB,CAAvB;;AAEA,MAAMC,YAAYV,QAAQ,oBAAR,CAAlB;AACAM,MAAIE,GAAJ,CAAQ,YAAR,EAAsBE,SAAtB;AACA;AACAJ,MAAIE,GAAJ,CAAQ,GAAR,EAAaP,MAAM,EAACU,QAAQ,IAAT,EAAN,CAAb;AACA;AACAL,MAAIE,GAAJ,CAAQ,GAAR,EAAa,UAAUI,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACrCD,QAAIE,MAAJ,CAAWC,UAAX,GAAwBJ,IAAIK,SAAJ,EAAxB;AACA;AACAH;AACD,GAJD;AAKA,MAAMI,QAAQlB,QAAQ,gBAAR,CAAd;AACAM,MAAIE,GAAJ,CAAQ,GAAR,EAAaU,KAAb;AACA;AACA;AACA,MAAMC,YAAYnB,QAAQ,oBAAR,CAAlB;AACAM,MAAIE,GAAJ,CAAQ,aAAR,EAAuBN,YAAvB,EAAqCiB,SAArC;;AAEAb,MAAIE,GAAJ,CAAQ,UAAUI,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAChC,QAAIM,MAAM,IAAIC,KAAJ,CAAU,WAAV,CAAV;AACAD,QAAIE,MAAJ,GAAa,GAAb;AACAR,SAAKM,GAAL;AACD,GAJD;;AAMF;AACEd,MAAIE,GAAJ,CAAQ,UAAUY,GAAV,EAAeR,GAAf,EAAoBC,GAApB,EAAyBC,IAAzB,EAA+B;AACrC;AACAD,QAAIE,MAAJ,CAAWQ,OAAX,GAAqBH,IAAIG,OAAzB;AACAV,QAAIE,MAAJ,CAAWS,KAAX,GAAmBZ,IAAIN,GAAJ,CAAQmB,GAAR,CAAY,KAAZ,MAAuB,aAAvB,GAAuCL,GAAvC,GAA6C,EAAhE;;AAEA;AACAP,QAAIS,MAAJ,CAAWF,IAAIE,MAAJ,IAAc,GAAzB;AACAT,QAAIa,MAAJ,CAAW,OAAX;AACD,GARD;AAUD,CAxCD","file":"routes.js","sourcesContent":["'use strict'\nconst cors = require('cors')\nconst csurf = require('csurf')\nconst authenticate = require('./lib/authenticate')\nconst passport = require('passport')\nmodule.exports = function (app) {\n\n  app.disable('x-powered-by')\n  app.use(cors())\n  app.set('trust proxy', 1)\n\n  const marketing = require('./routes/marketing')\n  app.use('/marketing', marketing)\n  // /marketing/newsletter/join\n  app.use('/', csurf({cookie: true}))\n  // let authorize = require('./lib/authorization')\n  app.use('/', function (req, res, next) {\n    res.locals._csrfToken = req.csrfToken()\n    // res.locals.user = {user: req.user}\n    next()\n  })\n  const index = require('./routes/index')\n  app.use('/', index)\n  // const platform = require('./routes/platform')\n  // app.use('/platform', authenticate, platform)\n  const tokensale = require('./routes/tokensale')\n  app.use('/token-sale', authenticate, tokensale)\n\n  app.use(function (req, res, next) {\n    var err = new Error('Not Found')\n    err.status = 404\n    next(err)\n  })\n\n// error handler\n  app.use(function (err, req, res, next) {\n    // set locals, only providing error in development\n    res.locals.message = err.message\n    res.locals.error = req.app.get('env') === 'development' ? err : {}\n\n    // render the error page\n    res.status(err.status || 500)\n    res.render('error')\n  })\n\n}"]}