{"version":3,"sources":["../../lib/app.js"],"names":["require","DateTime","passwordValidator","vue","Vue","el","data","country_code","csrf","crypto_type","first_name","last_name","us_citizen","purchase_amount","token","methods","onWhitelist","event","validateForm","$data","timeZone","local","_csrf","$","ajax","method","url","dataType","done","success","window","location","removeClass","addClass","children","text","message","fail","e","responseJSON","regex","RegExp","isValid","parents","length","parent","recaptchaCallback","resetRecaptcha","prop","grecaptcha","reset","clearForm","verified","cb","_token","serializeArray","hasError","json","i","value","name","Error","schema","is","min","max","has","uppercase","lowercase","digits","not","spaces","oneOf","registerForm","email","confirm_pwd","pwd","onSubmit","validateEmail","violations","validate","list","msg","join","setTimeout","always","test","clear","VueApp"],"mappings":"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","file":"app.js","sourcesContent":["'use strict'\nlet {DateTime} = require('luxon')\nvar passwordValidator = require('password-validator')\n\nvar vue = new Vue({\n  el: '#identity-form',\n  data: function () {\n    return {\n      country_code: '',\n      csrf: '',\n      crypto_type: '',\n      first_name: '',\n      last_name: '',\n      us_citizen: false,\n      purchase_amount: '',\n      token: ''\n    }\n  },\n  methods: {\n    onWhitelist: function (event) {\n      if (!this.validateForm()) {\n        return\n      }\n      var data = this.$data\n      data['g-recaptcha-response'] = this.$data.token\n      data.timeZone = DateTime.local()\n      data._csrf = this.$data.csrf\n      $.ajax({\n        method: 'POST',\n        url: '/platform/token-sale',\n        data: data,\n        dataType: 'json'\n      }).done(function (data) {\n        if (data.success) {\n          window.location = '/platform/token-sale'\n        } else {\n          $('#whitelist-alert').removeClass('invisible').addClass('alert-danger').children('.message').text(data.message)\n        }\n      }).fail(function (e) {\n        if (e.responseJSON) {\n          $('#whitelist-alert').removeClass('invisible').addClass('alert-danger').children('.message').text(e.responseJSON.message)\n        } else {\n          $('#whitelist-alert').removeClass('invisible').addClass('alert-danger').children('.message').text('An error occurred please try again later.')\n        }\n      })\n      return false\n    },\n    validateForm: function () {\n      $('.has-error').removeClass('has-error')\n      var regex = new RegExp(/.+\\@.+\\..+/)\n      var isValid = true\n\n      if ((!this.$data.crypto_type)) {\n        $('input[name=crypto_type]').parents('.form-group').addClass('has-error')\n        isValid = false\n      }\n      if (this.$data.purchase_amount === 'null' || !this.$data.purchase_amount.length) {\n        $('select[name=purchase_amount]').parent('.form-group').addClass('has-error')\n        isValid = false\n      }\n      return isValid\n    },\n    recaptchaCallback: function (token) {\n      // vm.token = null\n      if (!this.validateForm()) {\n        this.resetRecaptcha()\n        return\n      }\n      this.$data.token = token\n      $('#whitelistBtn').prop('disabled', false).removeClass('hide')\n    },\n    resetRecaptcha: function () {\n      $('#whitelistBtn').prop('disabled', true).addClass('hide')\n      grecaptcha.reset()\n    },\n    clearForm: function () {\n      resetRecaptcha()\n      this.$data.country_code = ''\n      this.$data.csrf = ''\n      this.$data.crypto_type = ''\n      this.$data.first_name = ''\n      this.$data.last_name = ''\n      this.$data.us_citizen = false\n      this.$data.purchase_amount = ''\n      this.$data.token = ''\n      $('select[name=purchase_amount]').prop('selectedIndex', 0)\n      $('input[name=crypto_type]:checked').prop('checked', false)\n    },\n    verified: function (token, cb) {\n      var _token = token\n      var data = $('#whitelist-form').serializeArray()\n      var hasError = false\n      var json = {}\n      for (var i = 0; i < data.length; i++) {\n        if (!data[i].value) {\n          $('#whitelist-form').addClass('has-error')\n          hasError = true\n        } else {\n          if (data[i].name === 'g-recaptcha-response') {\n            hasError = data[i].value !== _token\n          }\n        }\n        json[data[i].name] = data[i].value\n      }\n\n      if (hasError) {\n        return cb(new Error('validation failed'))\n      }\n      return cb(null, data)\n    }\n  }\n})\n\n// Create a schema\nvar schema = new passwordValidator()\n\n// Add properties to it\nschema\n.is().min(6)                                    // Minimum length 8\n.is().max(100)                                  // Maximum length 100\n.has().uppercase()                              // Must have uppercase letters\n.has().lowercase()                              // Must have lowercase letters\n.has().digits()                                 // Must have digits\n.has().not().spaces()                           // Should not have spaces\n.is().not().oneOf(['Passw0rd', 'Password123']) // Blacklist these values\n\nvar registerForm = new Vue({\n  el: '#signup-form',\n  data: function () {\n    return {\n      email: '',\n      csrf: '{{csrfToken}}',\n      first_name: '',\n      last_name: '',\n      confirm_pwd: '',\n      pwd: ''\n    }\n  },\n  methods: {\n    onSubmit: function (event) {\n      // $('#signup-alert').removeClass('alert-danger').children('.message')\n      var email = this.$data.email\n      if (!this.validateEmail(email)) {\n        $('#signup-alert').removeClass('invisible').addClass('alert-danger').children('.message').text('Please enter a valid e-mail address.')\n        return\n      }\n\n      if (this.$data.pwd !== this.$data.confirm_pwd) {\n        $('#signup-alert').addClass('alert-danger').children('.message').text('Passwords do not match.')\n        return\n      }\n\n      var violations = schema.validate(this.$data.pwd, {list: true})\n\n      if (violations.length) {\n        var msg = 'Password requires: ' + violations.join(' ') + ' characters.'\n        $('#signup-alert').addClass('alert-danger').children('.message').text(msg)\n        return\n      }\n\n      $.ajax({\n        method: 'POST',\n        url: '/api/v1/users/',\n        data: this.$data,\n        dataType: 'json'\n      }).done(function (data) {\n        if (data.success) {\n          $('#signup-alert').addClass('alert-success').children('.message').text('Account created successfully, please check your email to confirm your account')\n          setTimeout(function () {\n            window.location = '/login'\n          }, 3000)\n        } else {\n          $('#signup-alert').addClass('alert-danger').children('.message').text(data.message)\n        }\n      }).fail(function (e) {\n        $('#signup-alert').removeClass('invisible').addClass('text-danger').text('An error occurred')\n      }).always(function () {\n        setTimeout(function () {\n          $('#signup-alert').removeClass('alert-danger').removeClass('alert-success').children('.message').text('')\n        }, 7000)\n      })\n      return false\n    },\n    validateEmail: function (email) {\n      var regex = new RegExp(/.+\\@.+\\..+/)\n      if ((!email) || !regex.test(email)) {\n        return false\n      }\n      return true\n    },\n    clear: function () {\n      this.$data.email = ''\n      this.$data.csrf = ''\n      this.$data.first_name = ''\n      this.$data.last_name = ''\n      this.$data.confirm_pwd = ''\n      this.$data.pwd = ''\n      $('#signup-alert').removeClass('alert-danger').removeClass('alert-success').children('.message').text('')\n    }\n  }\n})\n\nwindow.VueApp = window.VueApp || vue\nwindow.registerForm = window.registerForm || registerForm\n"]}