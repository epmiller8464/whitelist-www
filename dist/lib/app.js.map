{"version":3,"sources":["../../lib/app.js"],"names":["require","DateTime","passwordValidator","vue","Vue","el","data","country_code","csrf","crypto_type","first_name","last_name","us_citizen","purchase_amount","token","methods","onWhitelist","event","validateForm","$data","timeZone","local","_csrf","$","ajax","method","url","dataType","done","success","removeClass","addClass","children","text","message","window","location","fail","e","responseJSON","regex","RegExp","isValid","cryptoType","parents","purchaseAmount","length","parent","recaptchaCallback","resetRecaptcha","prop","grecaptcha","reset","clearForm","verified","cb","_token","serializeArray","hasError","json","i","value","name","Error","schema","is","min","max","has","uppercase","lowercase","digits","not","spaces","oneOf","registerForm","email","confirm_pwd","pwd","onSubmit","validateEmail","violations","validate","list","msg","join","always","setTimeout","modal","test","clear","backdrop","show","VueApp"],"mappings":"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","file":"app.js","sourcesContent":["'use strict'\nlet {DateTime} = require('luxon')\nvar passwordValidator = require('password-validator')\n\nvar vue = new Vue({\n  el: '#identity-form',\n  data: function () {\n    return {\n      country_code: '',\n      csrf: '',\n      crypto_type: '',\n      first_name: '',\n      last_name: '',\n      us_citizen: false,\n      purchase_amount: '',\n      token: ''\n    }\n  },\n  methods: {\n    onWhitelist: function (event) {\n      if (!this.validateForm()) {\n        return\n      }\n      var data = this.$data\n      data['g-recaptcha-response'] = this.$data.token\n      data.timeZone = DateTime.local()\n      data._csrf = this.$data.csrf\n      $.ajax({\n        method: 'POST',\n        url: '/platform/token-sale',\n        data: data,\n        dataType: 'json'\n      }).done(function (data) {\n        if (data.success) {\n          $('#whitelist-alert').removeClass('invisible').addClass('alert-success').children('.message').text(data.message)\n        } else {\n          window.location = '/platform/token-sale'\n          // $('#whitelist-alert').removeClass('invisible').addClass('alert-danger').children('.message').text(data.message)\n        }\n      }).fail(function (e) {\n        if (e.responseJSON) {\n          $('#whitelist-alert').removeClass('invisible').addClass('alert-danger').children('.message').text(e.responseJSON.message)\n        } else {\n          $('#whitelist-alert').removeClass('invisible').addClass('alert-danger').children('.message').text('An error occurred please try again later.')\n        }\n      })\n      return false\n    },\n    validateForm: function () {\n      $('.has-error').removeClass('has-error')\n      var regex = new RegExp(/.+\\@.+\\..+/)\n      var isValid = true\n\n      if ((!this.$data.cryptoType)) {\n        $('input[name=cryptoType]').parents('.form-group').addClass('has-error')\n        isValid = false\n      }\n      if (this.$data.purchaseAmount === 'null' || !this.$data.purchaseAmount.length) {\n        $('select[name=purchaseAmount]').parent('.form-group').addClass('has-error')\n        isValid = false\n      }\n      return isValid\n    },\n    recaptchaCallback: function (token) {\n      // vm.token = null\n      if (!this.validateForm()) {\n        this.resetRecaptcha()\n        return\n      }\n      this.$data.token = token\n      $('#whitelistBtn').prop('disabled', false).removeClass('hide')\n    },\n    resetRecaptcha: function () {\n      $('#whitelistBtn').prop('disabled', true).addClass('hide')\n      grecaptcha.reset()\n    },\n    clearForm: function () {\n      resetRecaptcha()\n      this.$data.country_code = ''\n      this.$data.csrf = ''\n      this.$data.crypto_type = ''\n      this.$data.first_name = ''\n      this.$data.last_name = ''\n      this.$data.us_citizen = false\n      this.$data.purchase_amount = ''\n      this.$data.token = ''\n      $('select[name=purchaseAmount]').prop('selectedIndex', 0)\n      $('input[name=cryptoType]:checked').prop('checked', false)\n    },\n    verified: function (token, cb) {\n      var _token = token\n      var data = $('#whitelist-form').serializeArray()\n      var hasError = false\n      var json = {}\n      for (var i = 0; i < data.length; i++) {\n        if (!data[i].value) {\n          $('#whitelist-form').addClass('has-error')\n          hasError = true\n        } else {\n          if (data[i].name === 'g-recaptcha-response') {\n            hasError = data[i].value !== _token\n          }\n        }\n        json[data[i].name] = data[i].value\n      }\n\n      if (hasError) {\n        return cb(new Error('validation failed'))\n      }\n      return cb(null, data)\n    }\n  }\n})\n\n// Create a schema\nvar schema = new passwordValidator()\n\n// Add properties to it\nschema\n.is().min(6)                                    // Minimum length 8\n.is().max(100)                                  // Maximum length 100\n.has().uppercase()                              // Must have uppercase letters\n.has().lowercase()                              // Must have lowercase letters\n.has().digits()                                 // Must have digits\n.has().not().spaces()                           // Should not have spaces\n.is().not().oneOf(['Passw0rd', 'Password123']) // Blacklist these values\n\nvar registerForm = new Vue({\n  el: '#signup-form',\n  data: function () {\n    return {\n      email: '',\n      csrf: '{{csrfToken}}',\n      first_name: '',\n      last_name: '',\n      confirm_pwd: '',\n      pwd: ''\n    }\n  },\n  methods: {\n    onSubmit: function (event) {\n      var email = this.$data.email\n      if (!this.validateEmail(email)) {\n        $('#alert-label').removeClass('invisible').addClass('text-danger').text('Please enter a valid e=mail address.')\n        return\n      }\n\n      var violations = schema.validate(this.$data.pwd, {list: true})\n\n      if (violations.length) {\n        var msg = 'Password requires: ' + violations.join(' ') + ' characters.'\n        $('#signup-alert').addClass('alert-danger').children('.message').text(msg)\n        return\n      }\n\n      $.ajax({\n        method: 'POST',\n        url: '/api/v1/users/',\n        data: this.$data,\n        dataType: 'json'\n      }).done(function (data) {\n        if (data.success) {\n          $('#signup-alert').addClass('alert-success').children('.message').text('Account created successfully, please check your email to confirm your account')\n        } else {\n          $('#signup-alert').addClass('alert-danger').children('.message').text(data.message)\n        }\n      }).fail(function (e) {\n        $('#signup-alert').removeClass('invisible').addClass('text-danger').text('An error occurred')\n      }).always(function () {\n        setTimeout(function () {\n          $('#signup-alert').removeClass('alert-danger').removeClass('alert-success').children('.message').text('')\n          $('#signup-modal').modal('hide')\n        }, 7000)\n      })\n      return false\n    },\n    validateEmail: function (email) {\n      var regex = new RegExp(/.+\\@.+\\..+/)\n      if ((!email) || !regex.test(email)) {\n        return false\n      }\n      return true\n    },\n    clear: function () {\n      this.$data.email = ''\n      this.$data.csrf = ''\n      this.$data.first_name = ''\n      this.$data.last_name = ''\n      this.$data.confirm_pwd = ''\n      this.$data.pwd = ''\n      $('#signup-alert').removeClass('alert-danger').removeClass('alert-success').children('.message').text('')\n    }\n  }\n})\n$('#signup-modal').modal({backdrop: 'static', show: false})\nwindow.VueApp = window.VueApp || vue\nwindow.registerForm = window.registerForm || registerForm\n"]}