{"version":3,"sources":["../../../lib/setup/session.js"],"names":["expressSession","require","uuid","module","exports","app","sess","genid","req","v4","secret","process","env","APP_SECRET","resave","saveUninitialized","NODE_ENV","set","cookie","secure","use"],"mappings":"AAAA;;AACA,IAAMA,iBAAiBC,QAAQ,iBAAR,CAAvB;AACA,IAAMC,OAAOD,QAAQ,MAAR,CAAb;AACAE,OAAOC,OAAP,GAAiB,UAACC,GAAD,EAAS;AACxB,MAAIC,OAAO;AACTC,WAAO,eAAUC,GAAV,EAAe;AACpB,aAAON,KAAKO,EAAL,EAAP,CADoB,CACH;AAClB,KAHQ;AAITC,YAAQC,QAAQC,GAAR,CAAYC,UAJX;AAKTC,YAAQ,KALC;AAMTC,uBAAmB;AANV,GAAX;AAQA;AACA;AACA;AACA;AACA;AACA,MAAIJ,QAAQC,GAAR,CAAYI,QAAZ,KAAyB,YAA7B,EAA2C;AACzCX,QAAIY,GAAJ,CAAQ,aAAR,EAAuB,CAAvB,EADyC,CACf;AAC1BX,SAAKY,MAAL,CAAYC,MAAZ,GAAqB,IAArB,CAFyC,CAEf;AAC3B;;AAEDd,MAAIe,GAAJ,CAAQpB,eAAeM,IAAf,CAAR;AACD,CApBD","file":"session.js","sourcesContent":["'use strict'\nconst expressSession = require('express-session')\nconst uuid = require('uuid')\nmodule.exports = (app) => {\n  let sess = {\n    genid: function (req) {\n      return uuid.v4() // use UUIDs for session IDs\n    },\n    secret: process.env.APP_SECRET,\n    resave: false,\n    saveUninitialized: true\n  }\n  // app.use(session({\n  //   secret: process.env.APP_SECRET,\n  //   resave: false,\n  //   saveUninitialized: true\n  // }))\n  if (process.env.NODE_ENV === 'production') {\n    app.set('trust proxy', 1) // trust first proxy\n    sess.cookie.secure = true // serve secure cookies\n  }\n\n  app.use(expressSession(sess))\n}\n"]}