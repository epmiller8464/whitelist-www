{"version":3,"sources":["../../lib/db.js"],"names":["config","require","mongoose","module","exports","cb","Promise","dbOptions","useMongoClient","promiseLibrary","global","connect","db","MONGO_DB_URI","then","on","console","info","bind","error","once","callback","log"],"mappings":"AAAA;;AACA,IAAIA,SAASC,QAAQ,WAAR,CAAb;AACA,IAAIC,WAAWD,QAAQ,UAAR,CAAf;;AAEAE,OAAOC,OAAP,GAAiB,UAAUC,EAAV,EAAc;AAC7BH,WAASI,OAAT,GAAmBA,OAAnB;AACA,MAAIC,YAAY;AACdC,oBAAgB,IADF;AAEdC,oBAAgBC,OAAOJ;AAFT,GAAhB;;AAKAJ,WAASS,OAAT,CAAiBX,OAAOY,EAAP,CAAUC,YAA3B,EAAyCN,SAAzC,EACCO,IADD,CACM,UAACF,EAAD,EAAQ;AACZA,OAAGG,EAAH,CAAM,MAAN,EAAcC,QAAQC,IAAR,CAAaC,IAAb,CAAkBF,OAAlB,EAA2B,iBAA3B,CAAd;AACAJ,OAAGG,EAAH,CAAM,OAAN,EAAeC,QAAQG,KAAR,CAAcD,IAAd,CAAmBF,OAAnB,EAA4B,kBAA5B,CAAf;AACAJ,OAAGQ,IAAH,CAAQ,MAAR,EAAgB,UAACC,QAAD,EAAc;AAACL,cAAQM,GAAR,CAAY,MAAZ;AAAoB,KAAnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAOjB,GAAGO,EAAH,CAAP;AACD,GAZD;AAaD,CApBD;AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"db.js","sourcesContent":["'use strict'\nlet config = require('../config')\nlet mongoose = require('mongoose')\n\nmodule.exports = function (cb) {\n  mongoose.Promise = Promise\n  let dbOptions = {\n    useMongoClient: true,\n    promiseLibrary: global.Promise\n  }\n\n  mongoose.connect(config.db.MONGO_DB_URI, dbOptions)\n  .then((db) => {\n    db.on('open', console.info.bind(console, 'connection open'))\n    db.on('error', console.error.bind(console, 'connection error'))\n    db.once('open', (callback) => {console.log('open')})\n    // process.on('SIGINT', () => {\n    //   db.close(() => {\n    //     console.log('process terminated, connection closed')\n    //     process.exit(0)\n    //   })\n    // })\n    return cb(db)\n  })\n}\n// module.exports = (mongoose, config) => {\n//   const database = mongoose.connection\n//   mongoose.Promise = Promise\n//   mongoose.connect(config.database, {\n//     useMongoClient: true,\n//     promiseLibrary: global.Promise\n//   })\n//   database.on('error', error => console.log(`Connection to database failed: ${error}`))\n//   database.on('connected', () => console.log('Connected to database'))\n//   database.on('disconnected', () => console.log('Disconnected from database'))\n//   process.on('SIGINT', () => {\n//     database.close(() => {\n//       console.log('process terminated, connection closed')\n//       process.exit(0)\n//     })\n//   })\n// }\n"]}