{"version":3,"sources":["../../lib/db.js"],"names":["config","require","mongoose","decrypt","module","exports","cb","Promise","dbOptions","useMongoClient","promiseLibrary","global","connect","process","env","MONGODB_URI","then","db","on","console","info","bind","error","once","callback","log"],"mappings":"AAAA;;AACA,IAAIA,SAASC,QAAQ,WAAR,CAAb;AACA,IAAIC,WAAWD,QAAQ,UAAR,CAAf;;eACkBA,QAAQ,UAAR,C;IAAXE,O,YAAAA,O;;AACPC,OAAOC,OAAP,GAAiB,UAAUC,EAAV,EAAc;AAC7BJ,WAASK,OAAT,GAAmBA,OAAnB;AACA,MAAIC,YAAY;AACdC,oBAAgB,IADF;AAEdC,oBAAgBC,OAAOJ;AAFT,GAAhB;;AAKAL,WAASU,OAAT,CAAiBT,QAAQU,QAAQC,GAAR,CAAYC,WAApB,CAAjB,EAAmDP,SAAnD,EACCQ,IADD,CACM,UAACC,EAAD,EAAQ;AACZA,OAAGC,EAAH,CAAM,MAAN,EAAcC,QAAQC,IAAR,CAAaC,IAAb,CAAkBF,OAAlB,EAA2B,iBAA3B,CAAd;AACAF,OAAGC,EAAH,CAAM,OAAN,EAAeC,QAAQG,KAAR,CAAcD,IAAd,CAAmBF,OAAnB,EAA4B,kBAA5B,CAAf;AACAF,OAAGM,IAAH,CAAQ,MAAR,EAAgB,UAACC,QAAD,EAAc;AAACL,cAAQM,GAAR,CAAY,MAAZ;AAAoB,KAAnD;AACA,WAAOnB,GAAGW,EAAH,CAAP;AACD,GAND;AAOD,CAdD","file":"db.js","sourcesContent":["'use strict'\nlet config = require('../config')\nlet mongoose = require('mongoose')\nconst {decrypt} = require('./crypto')\nmodule.exports = function (cb) {\n  mongoose.Promise = Promise\n  let dbOptions = {\n    useMongoClient: true,\n    promiseLibrary: global.Promise\n  }\n\n  mongoose.connect(decrypt(process.env.MONGODB_URI), dbOptions)\n  .then((db) => {\n    db.on('open', console.info.bind(console, 'connection open'))\n    db.on('error', console.error.bind(console, 'connection error'))\n    db.once('open', (callback) => {console.log('open')})\n    return cb(db)\n  })\n}\n"]}