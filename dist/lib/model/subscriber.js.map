{"version":3,"sources":["../../../lib/model/subscriber.js"],"names":["mongoose","require","Schema","encrypt","decrypt","module","exports","moment","schema","email","type","String","trim","unique","lowercase","required","minLength","match","verified","Boolean","default","subscribedTo","unsubscribeFrom","unsubscribeAll","meta","Types","Object","collection","index","Model","model","e"],"mappings":"AAAA;AACA;;AAEA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,SAASF,SAASE,MAAtB;;eAC2BD,QAAQ,WAAR,C;IAApBE,O,YAAAA,O;IAASC,O,YAAAA,O;;AAChBC,OAAOC,OAAP,GAAiB,YAAY;AAC3B,MAAMC,SAASN,QAAQ,QAAR,CAAf;AACA;AACA,MAAIO,SAAS,IAAIN,MAAJ,CAAW;AACtBO,WAAO;AACLC,YAAMC,MADD;AAELC,YAAM,IAFD;AAGLC,cAAQ,IAHH;AAILC,iBAAW,IAJN;AAKLC,gBAAU,IALL;AAMLC,iBAAW,CANN;AAOLC,aAAO;AAPF,KADe;AAYtBC,cAAU,EAACR,MAAMS,OAAP,EAAgBJ,UAAU,IAA1B,EAAgCK,SAAS,KAAzC,EAZY;AAatBC,kBAAc,CAACV,MAAD,CAbQ;AActBW,qBAAiB,CAACX,MAAD,CAdK;AAetBY,oBAAgB,EAACb,MAAMS,OAAP,EAAgBJ,UAAU,IAA1B,EAAgCK,SAAS,KAAzC,EAfM;AAgBtBI,UAAM,EAACd,MAAMV,SAASE,MAAT,CAAgBuB,KAAhB,CAAsBC,MAA7B;AAhBgB,GAAX,EAiBV,EAACC,YAAY,YAAb,EAjBU,CAAb;AAkBAnB,SAAOoB,KAAP,CAAa,EAACnB,OAAO,CAAR,EAAb;AACA,MAAIoB,cAAJ;AACA,MAAI;AACF;AACAA,YAAQ7B,SAAS8B,KAAT,CAAe,YAAf,CAAR;AACD,GAHD,CAGE,OAAOC,CAAP,EAAU;AACVF,YAAQ7B,SAAS8B,KAAT,CAAe,YAAf,EAA6BtB,MAA7B,CAAR;AACD;AACD,SAAOqB,KAAP;AACD,CA9BD","file":"subscriber.js","sourcesContent":["'use strict'\n'use strict'\n\nvar mongoose = require('mongoose')\nvar Schema = mongoose.Schema\nconst {encrypt, decrypt} = require('../crypto')\nmodule.exports = function () {\n  const moment = require('moment')\n  // let moment = require('moment')\n  let schema = new Schema({\n    email: {\n      type: String,\n      trim: true,\n      unique: true,\n      lowercase: true,\n      required: true,\n      minLength: 1,\n      match: /.+\\@.+\\..+/,\n      // get: (v) => { return decrypt(v) },\n      // set: v => encrypt(v)\n    },\n    verified: {type: Boolean, required: true, default: false},\n    subscribedTo: [String],\n    unsubscribeFrom: [String],\n    unsubscribeAll: {type: Boolean, required: true, default: false},\n    meta: {type: mongoose.Schema.Types.Object}\n  }, {collection: 'subscriber'})\n  schema.index({email: 1})\n  let Model\n  try {\n    // Throws an error if \"Name\" hasn't been registered\n    Model = mongoose.model('subscriber')\n  } catch (e) {\n    Model = mongoose.model('subscriber', schema)\n  }\n  return Model\n}\n"]}