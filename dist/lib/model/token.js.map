{"version":3,"sources":["../../../lib/model/token.js"],"names":["mongoose","require","moment","module","exports","Model","tokenSchema","Schema","token","type","String","required","createDate","Date","default","utc","epoch","Number","now","jwt_id","blackListed","Boolean","revoked","enum","collection","index","unique","jwtid","model","e"],"mappings":"AAAA;;AACA,IAAMA,WAAWC,QAAQ,UAAR,CAAjB;AACA,IAAIC,SAASD,QAAQ,QAAR,GAAb;;AAEAE,OAAOC,OAAP,GAAiB,YAAY;AAC3B,MAAIC,cAAJ;;AAEA,MAAIC,cAAc,IAAIN,SAASO,MAAb,CAAoB;AACpCC,WAAO,EAACC,MAAMC,MAAP,EAAeC,UAAU,IAAzB,EAD6B;AAEpCC,gBAAY,EAACH,MAAMI,IAAP,EAAaC,SAASZ,OAAOa,GAA7B,EAAkCJ,UAAU,IAA5C,EAFwB;AAGpCK,WAAO,EAACP,MAAMQ,MAAP,EAAeH,SAASD,KAAKK,GAA7B,EAAkCP,UAAU,IAA5C,EAH6B;AAIpCQ,YAAQ,EAACV,MAAMC,MAAP,EAAeC,UAAU,IAAzB,EAJ4B;AAKpCS,iBAAa,EAACX,MAAMY,OAAP,EAAgBV,UAAU,IAA1B,EAAgCG,SAAS,KAAzC,EALuB;AAMpCQ,aAAS,EAACb,MAAMY,OAAP,EAAgBV,UAAU,IAA1B,EAAgCG,SAAS,KAAzC,EAN2B;AAOpCL,UAAM,EAACA,MAAMC,MAAP,EAAeC,UAAU,IAAzB,EAA+BY,MAAM,CAAC,cAAD,EAAiB,SAAjB,EAA4B,QAA5B,CAArC;AAP8B,GAApB,EAQf,EAACC,YAAY,OAAb,EARe,CAAlB;;AAUAlB,cAAYmB,KAAZ,CAAkB,EAACjB,OAAO,CAAR,EAAlB,EAA8B,EAACkB,QAAQ,IAAT,EAA9B;AACApB,cAAYmB,KAAZ,CAAkB,EAACE,OAAO,CAAR,EAAlB,EAA8B,EAACD,QAAQ,IAAT,EAA9B;AACApB,cAAYmB,KAAZ,CAAkB,EAAChB,MAAM,CAAP,EAAlB;;AAEA,MAAI;AACF;AACAJ,YAAQL,SAAS4B,KAAT,CAAe,OAAf,CAAR;AACD,GAHD,CAGE,OAAOC,CAAP,EAAU;AACVxB,YAAQL,SAAS4B,KAAT,CAAe,OAAf,EAAwBtB,WAAxB,CAAR;AACD;AACD,SAAOD,KAAP;AACD,CAxBD","file":"token.js","sourcesContent":["'use strict'\nconst mongoose = require('mongoose')\nlet moment = require('moment')()\n\nmodule.exports = function () {\n  let Model\n\n  let tokenSchema = new mongoose.Schema({\n    token: {type: String, required: true},\n    createDate: {type: Date, default: moment.utc, required: true},\n    epoch: {type: Number, default: Date.now, required: true},\n    jwt_id: {type: String, required: true},\n    blackListed: {type: Boolean, required: true, default: false},\n    revoked: {type: Boolean, required: true, default: false},\n    type: {type: String, required: true, enum: ['verification', 'refresh', 'access']}\n  }, {collection: 'token'})\n\n  tokenSchema.index({token: 1}, {unique: true})\n  tokenSchema.index({jwtid: 1}, {unique: true})\n  tokenSchema.index({type: 1})\n\n  try {\n    // Throws an error if \"Name\" hasn't been registered\n    Model = mongoose.model('token')\n  } catch (e) {\n    Model = mongoose.model('token', tokenSchema)\n  }\n  return Model\n}"]}