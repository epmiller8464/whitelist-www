{"version":3,"sources":["../../../lib/model/whitelist.js"],"names":["mongoose","require","Schema","encrypt","decrypt","module","exports","whitelistSchema","firstName","String","lastName","email","type","trim","unique","lowercase","required","minLength","get","v","set","ip","pwh","salt","purchaseAmount","cryptoType","country","verified","Boolean","default","createDate","Date","now","publicHandles","Types","Object","meta","collection","Model","model","e"],"mappings":"AAAA;;AAEA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,SAASF,SAASE,MAAtB;;eAC2BD,QAAQ,WAAR,C;IAApBE,O,YAAAA,O;IAASC,O,YAAAA,O;;AAChBC,OAAOC,OAAP,GAAiB,YAAY;AAC3B;AACA,MAAIC,kBAAkB,IAAIL,MAAJ,CAAW;AAC/BM,eAAWC,MADoB;AAE/BC,cAAUD,MAFqB;AAG/BE,WAAO;AACLC,YAAMH,MADD;AAELI,YAAM,IAFD;AAGLC,cAAQ,IAHH;AAILC,iBAAW,IAJN;AAKLC,gBAAU,IALL;AAMLC,iBAAW,CANN;AAOLC,WAAK,aAACC,CAAD,EAAO;AAAE,eAAOf,QAAQe,CAAR,CAAP;AAAmB,OAP5B;AAQLC,WAAK;AAAA,eAAKjB,QAAQgB,CAAR,CAAL;AAAA;AARA,KAHwB;AAa/BE,QAAI;AACFT,YAAMH,MADJ;AAEFS,WAAK,aAACC,CAAD,EAAO;AAAE,eAAOf,QAAQe,CAAR,CAAP;AAAmB,OAF/B;AAGFC,WAAK;AAAA,eAAKjB,QAAQgB,CAAR,CAAL;AAAA;AAHH,KAb2B;AAkB/BG,SAAK,EAACb,cAAD,EAlB0B;AAmB/Bc,UAAM,EAACd,cAAD,EAnByB;AAoB/Be,oBAAgB;AACdZ,YAAMH,MADQ;AAEdS,WAAK,aAACC,CAAD,EAAO;AAAE,eAAOf,QAAQe,CAAR,CAAP;AAAmB,OAFnB;AAGdC,WAAK;AAAA,eAAKjB,QAAQgB,CAAR,CAAL;AAAA;AAHS,KApBe;AAyB/BM,gBAAY,EAACb,MAAMH,MAAP,EAzBmB;AA0B/BiB,aAASjB,MA1BsB;AA2B/BkB,cAAU,EAACf,MAAMgB,OAAP,EAAgBC,SAAS,KAAzB,EAAgCb,UAAU,IAA1C,EA3BqB;AA4B/Bc,gBAAY,EAAClB,MAAMmB,IAAP,EAAaF,SAASE,KAAKC,GAA3B,EAAgChB,UAAU,IAA1C,EA5BmB;AA6B/BiB,mBAAe,EAACrB,MAAMZ,SAASE,MAAT,CAAgBgC,KAAhB,CAAsBC,MAA7B,EA7BgB;AA8B/BC,UAAM,EAACxB,MAAMZ,SAASE,MAAT,CAAgBgC,KAAhB,CAAsBC,MAA7B;AA9ByB,GAAX,EA+BnB,EAACE,YAAY,WAAb,EA/BmB,CAAtB;;AAiCA,MAAIC,cAAJ;AACA,MAAI;AACF;AACAA,YAAQtC,SAASuC,KAAT,CAAe,WAAf,CAAR;AACD,GAHD,CAGE,OAAOC,CAAP,EAAU;AACVF,YAAQtC,SAASuC,KAAT,CAAe,WAAf,EAA4BhC,eAA5B,CAAR;AACD;AACD,SAAO+B,KAAP;AACD,CA3CD","file":"whitelist.js","sourcesContent":["'use strict'\n\nvar mongoose = require('mongoose')\nvar Schema = mongoose.Schema\nconst {encrypt, decrypt} = require('../crypto')\nmodule.exports = function () {\n  // let moment = require('moment')\n  let whitelistSchema = new Schema({\n    firstName: String,\n    lastName: String,\n    email: {\n      type: String,\n      trim: true,\n      unique: true,\n      lowercase: true,\n      required: true,\n      minLength: 1,\n      get: (v) => { return decrypt(v) },\n      set: v => encrypt(v)\n    },\n    ip: {\n      type: String,\n      get: (v) => { return decrypt(v) },\n      set: v => encrypt(v)\n    },\n    pwh: {String},\n    salt: {String},\n    purchaseAmount: {\n      type: String,\n      get: (v) => { return decrypt(v) },\n      set: v => encrypt(v)\n    },\n    cryptoType: {type: String},\n    country: String,\n    verified: {type: Boolean, default: false, required: true},\n    createDate: {type: Date, default: Date.now, required: true},\n    publicHandles: {type: mongoose.Schema.Types.Object},\n    meta: {type: mongoose.Schema.Types.Object}\n  }, {collection: 'whitelist'})\n\n  let Model\n  try {\n    // Throws an error if \"Name\" hasn't been registered\n    Model = mongoose.model('whitelist')\n  } catch (e) {\n    Model = mongoose.model('whitelist', whitelistSchema)\n  }\n  return Model\n}\n"]}