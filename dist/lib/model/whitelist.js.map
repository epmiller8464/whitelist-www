{"version":3,"sources":["../../../lib/model/whitelist.js"],"names":["mongoose","require","Schema","encrypt","decrypt","module","exports","whitelistSchema","firstName","String","lastName","email","type","trim","lowercase","required","minLength","get","v","set","ip","purchaseAmount","country","verified","Boolean","default","createDate","Date","now","meta","Types","Object","collection","Model","model","e"],"mappings":"AAAA;;AAEA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,SAASF,SAASE,MAAtB;;eAC2BD,QAAQ,WAAR,C;IAApBE,O,YAAAA,O;IAASC,O,YAAAA,O;;AAChBC,OAAOC,OAAP,GAAiB,YAAY;AAC3B;AACA,MAAIC,kBAAkB,IAAIL,MAAJ,CAAW;AAC/BM,eAAWC,MADoB;AAE/BC,cAAUD,MAFqB;AAG/BE,WAAO;AACLC,YAAMH,MADD;AAELI,YAAM,IAFD;AAGLC,iBAAW,IAHN;AAILC,gBAAU,IAJL;AAKLC,iBAAW,CALN;AAMLC,WAAK;AAAA,eAAKb,QAAQc,CAAR,CAAL;AAAA,OANA;AAOLC,WAAK;AAAA,eAAKhB,QAAQe,CAAR,CAAL;AAAA;AAPA,KAHwB;AAY/BE,QAAIX,MAZ2B;AAa/BY,oBAAgBZ,MAbe;AAc/Ba,aAASb,MAdsB;AAe/Bc,cAAU,EAACX,MAAMY,OAAP,EAAgBC,SAAS,KAAzB,EAAgCV,UAAU,IAA1C,EAfqB;AAgB/BW,gBAAY,EAACd,MAAMe,IAAP,EAAaF,SAASE,KAAKC,GAA3B,EAAgCb,UAAU,IAA1C,EAhBmB;AAiB/Bc,UAAM,EAACjB,MAAMZ,SAASE,MAAT,CAAgB4B,KAAhB,CAAsBC,MAA7B;AAjByB,GAAX,EAkBnB,EAACC,YAAY,WAAb,EAlBmB,CAAtB;;AAoBA,MAAIC,cAAJ;AACA,MAAI;AACF;AACAA,YAAQjC,SAASkC,KAAT,CAAe,WAAf,CAAR;AACD,GAHD,CAGE,OAAOC,CAAP,EAAU;AACVF,YAAQjC,SAASkC,KAAT,CAAe,WAAf,EAA4B3B,eAA5B,CAAR;AACD;AACD,SAAO0B,KAAP;AACD,CA9BD","file":"whitelist.js","sourcesContent":["'use strict'\n\nvar mongoose = require('mongoose')\nvar Schema = mongoose.Schema\nconst {encrypt, decrypt} = require('../crypto')\nmodule.exports = function () {\n  // let moment = require('moment')\n  let whitelistSchema = new Schema({\n    firstName: String,\n    lastName: String,\n    email: {\n      type: String,\n      trim: true,\n      lowercase: true,\n      required: true,\n      minLength: 1,\n      get: v => decrypt(v),\n      set: v => encrypt(v)\n    },\n    ip: String,\n    purchaseAmount: String,\n    country: String,\n    verified: {type: Boolean, default: false, required: true},\n    createDate: {type: Date, default: Date.now, required: true},\n    meta: {type: mongoose.Schema.Types.Object}\n  }, {collection: 'whitelist'})\n\n  let Model\n  try {\n    // Throws an error if \"Name\" hasn't been registered\n    Model = mongoose.model('whitelist')\n  } catch (e) {\n    Model = mongoose.model('whitelist', whitelistSchema)\n  }\n  return Model\n}\n"]}