{"version":3,"sources":["../../../lib/model/whitelist.js"],"names":["mongoose","require","Schema","encrypt","decrypt","module","exports","moment","whitelistSchema","ip","type","String","required","purchase_amount","get","v","set","crypto_type","country_code","us_citizen","Boolean","default","can_participate","verified","create_date","Date","utc","timezone","ts","zoneName","offset","owner_id","Types","ObjectId","ref","unique","meta","Object","collection","getters","index","Model","model","e"],"mappings":"AAAA;;AAEA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,SAASF,SAASE,MAAtB;;eAC2BD,QAAQ,WAAR,C;IAApBE,O,YAAAA,O;IAASC,O,YAAAA,O;;AAChBC,OAAOC,OAAP,GAAiB,YAAY;AAC3B,MAAMC,SAASN,QAAQ,QAAR,CAAf;AACA;AACA,MAAIO,kBAAkB,IAAIN,MAAJ,CAAW;AAC/BO,QAAI,EAACC,MAAMC,MAAP,EAAeC,UAAU,IAAzB,EAD2B;AAE/BC,qBAAiB,EAACH,MAAMC,MAAP,EAAeG,KAAK,aAACC,CAAD,EAAO;AAAE,eAAOX,QAAQW,CAAR,CAAP;AAAmB,OAAhD,EAAkDC,KAAK;AAAA,eAAKb,QAAQY,CAAR,CAAL;AAAA,OAAvD,EAFc;AAG/BE,iBAAa,EAACP,MAAMC,MAAP,EAHkB;AAI/BO,kBAAc,EAACR,MAAMC,MAAP,EAAeC,UAAU,IAAzB,EAJiB;AAK/BO,gBAAY,EAACT,MAAMU,OAAP,EAAgBC,SAAS,KAAzB,EAAgCT,UAAU,IAA1C,EALmB;AAM/BU,qBAAiB,EAACZ,MAAMU,OAAP,EAAgBC,SAAS,IAAzB,EAA+BT,UAAU,IAAzC,EANc;AAO/BW,cAAU,EAACb,MAAMU,OAAP,EAAgBC,SAAS,KAAzB,EAAgCT,UAAU,IAA1C,EAPqB;AAQ/BY,iBAAa,EAACd,MAAMe,IAAP,EAAaJ,SAASd,OAAOmB,GAA7B,EAAkCd,UAAU,IAA5C,EARkB;AAS/Be,cAAU;AACRC,UAAIjB,MADI;AAERkB,gBAAUlB,MAFF;AAGRmB,cAAQnB;AAHA,KATqB;AAc/BoB,cAAU,EAACrB,MAAMV,SAASE,MAAT,CAAgB8B,KAAhB,CAAsBC,QAA7B,EAAuCC,KAAK,MAA5C,EAAoDtB,UAAU,IAA9D,EAAoEuB,QAAQ,IAA5E,EAdqB;AAe/BC,UAAM,EAAC1B,MAAMV,SAASE,MAAT,CAAgB8B,KAAhB,CAAsBK,MAA7B;AAfyB,GAAX,EAgBnB,EAACC,YAAY,WAAb,EAhBmB,CAAtB;AAiBA9B,kBAAgBQ,GAAhB,CAAoB,UAApB,EAAgC,EAACuB,SAAS,IAAV,EAAhC;AACA;AACA/B,kBAAgBgC,KAAhB,CAAsB,EAAC/B,IAAI,CAAL,EAAtB;AACA,MAAIgC,cAAJ;AACA,MAAI;AACF;AACAA,YAAQzC,SAAS0C,KAAT,CAAe,WAAf,CAAR;AACD,GAHD,CAGE,OAAOC,CAAP,EAAU;AACVF,YAAQzC,SAAS0C,KAAT,CAAe,WAAf,EAA4BlC,eAA5B,CAAR;AACD;AACD,SAAOiC,KAAP;AACD,CA/BD","file":"whitelist.js","sourcesContent":["'use strict'\n\nvar mongoose = require('mongoose')\nvar Schema = mongoose.Schema\nconst {encrypt, decrypt} = require('../crypto')\nmodule.exports = function () {\n  const moment = require('moment')\n  // let moment = require('moment')\n  let whitelistSchema = new Schema({\n    ip: {type: String, required: true},\n    purchase_amount: {type: String, get: (v) => { return decrypt(v) }, set: v => encrypt(v)},\n    crypto_type: {type: String},\n    country_code: {type: String, required: true},\n    us_citizen: {type: Boolean, default: false, required: true},\n    can_participate: {type: Boolean, default: true, required: true},\n    verified: {type: Boolean, default: false, required: true},\n    create_date: {type: Date, default: moment.utc, required: true},\n    timezone: {\n      ts: String,\n      zoneName: String,\n      offset: String\n    },\n    owner_id: {type: mongoose.Schema.Types.ObjectId, ref: 'user', required: true, unique: true},\n    meta: {type: mongoose.Schema.Types.Object}\n  }, {collection: 'whitelist'})\n  whitelistSchema.set('toObject', {getters: true})\n  // whitelistSchema.index({jwtid: 1}, {unique: true})\n  whitelistSchema.index({ip: 1})\n  let Model\n  try {\n    // Throws an error if \"Name\" hasn't been registered\n    Model = mongoose.model('whitelist')\n  } catch (e) {\n    Model = mongoose.model('whitelist', whitelistSchema)\n  }\n  return Model\n}\n"]}