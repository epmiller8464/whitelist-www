{"version":3,"sources":["../../lib/crypto.js"],"names":["crypto","require","ENCRYPTION_KEY","process","env","PK","IV_LENGTH","encrypt","text","iv","randomBytes","cipher","createCipheriv","Buffer","from","encrypted","update","concat","final","toString","decrypt","textParts","split","shift","encryptedText","join","decipher","createDecipheriv","decrypted","module","exports"],"mappings":"AAAA;;AACA,IAAMA,SAASC,QAAQ,QAAR,CAAf;;AAEA,IAAMC,iBAAiBC,QAAQC,GAAR,CAAYC,EAAnC,C,CAAsC;AACtC,IAAMC,YAAY,EAAlB,C,CAAqB;;AAErB,SAASC,OAAT,CAAkBC,IAAlB,EAAwB;AACtB,MAAIC,KAAKT,OAAOU,WAAP,CAAmBJ,SAAnB,CAAT;AACA,MAAIK,SAASX,OAAOY,cAAP,CAAsB,aAAtB,EAAqCC,OAAOC,IAAP,CAAYZ,cAAZ,EAA4B,KAA5B,CAArC,EAAyEO,EAAzE,CAAb;AACA,MAAIM,YAAYJ,OAAOK,MAAP,CAAcR,IAAd,CAAhB;;AAEAO,cAAYF,OAAOI,MAAP,CAAc,CAACF,SAAD,EAAYJ,OAAOO,KAAP,EAAZ,CAAd,CAAZ;;AAEA,SAAOT,GAAGU,QAAH,CAAY,KAAZ,IAAqB,GAArB,GAA2BJ,UAAUI,QAAV,CAAmB,KAAnB,CAAlC;AACD;;AAED,SAASC,OAAT,CAAkBZ,IAAlB,EAAwB;AACtB,MAAIa,YAAYb,KAAKc,KAAL,CAAW,GAAX,CAAhB;AACA,MAAIb,KAAKI,OAAOC,IAAP,CAAYO,UAAUE,KAAV,EAAZ,EAA+B,KAA/B,CAAT;AACA,MAAIC,gBAAgBX,OAAOC,IAAP,CAAYO,UAAUI,IAAV,CAAe,GAAf,CAAZ,EAAiC,KAAjC,CAApB;AACA,MAAIC,WAAW1B,OAAO2B,gBAAP,CAAwB,aAAxB,EAAuCd,OAAOC,IAAP,CAAYZ,cAAZ,EAA4B,KAA5B,CAAvC,EAA2EO,EAA3E,CAAf;AACA,MAAImB,YAAYF,SAASV,MAAT,CAAgBQ,aAAhB,CAAhB;;AAEAI,cAAYf,OAAOI,MAAP,CAAc,CAACW,SAAD,EAAYF,SAASR,KAAT,EAAZ,CAAd,CAAZ;;AAEA,SAAOU,UAAUT,QAAV,EAAP;AACD;;AAEDU,OAAOC,OAAP,GAAiB,EAACV,gBAAD,EAAUb,gBAAV,EAAjB","file":"crypto.js","sourcesContent":["'use strict'\nconst crypto = require('crypto')\n\nconst ENCRYPTION_KEY = process.env.PK // Must be 256 bytes (32 characters)\nconst IV_LENGTH = 16 // For AES, this is always 16\n\nfunction encrypt (text) {\n  let iv = crypto.randomBytes(IV_LENGTH)\n  let cipher = crypto.createCipheriv('aes-256-cbc', Buffer.from(ENCRYPTION_KEY, 'hex'), iv)\n  let encrypted = cipher.update(text)\n\n  encrypted = Buffer.concat([encrypted, cipher.final()])\n\n  return iv.toString('hex') + ':' + encrypted.toString('hex')\n}\n\nfunction decrypt (text) {\n  let textParts = text.split(':')\n  let iv = Buffer.from(textParts.shift(), 'hex')\n  let encryptedText = Buffer.from(textParts.join(':'), 'hex')\n  let decipher = crypto.createDecipheriv('aes-256-cbc', Buffer.from(ENCRYPTION_KEY, 'hex'), iv)\n  let decrypted = decipher.update(encryptedText)\n\n  decrypted = Buffer.concat([decrypted, decipher.final()])\n\n  return decrypted.toString()\n}\n\nmodule.exports = {decrypt, encrypt}\n"]}