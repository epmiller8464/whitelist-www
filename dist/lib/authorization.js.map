{"version":3,"sources":["../../lib/authorization.js"],"names":["_","require","authorize","req","res","next","user","called","includes","role","m","encodeURIComponent","log","error","redirect","unless","module","exports"],"mappings":"AAAA;;AACA,IAAMA,IAAIC,QAAQ,QAAR,CAAV;AACA,IAAMC,YAAY,SAAZA,SAAY,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACpC,MAAIC,OAAOH,IAAIG,IAAf;AACAH,MAAII,MAAJ,GAAa,IAAb;AACA,MAAID,QAASN,EAAEQ,QAAF,CAAW,CAAC,OAAD,EAAU,MAAV,CAAX,EAA8BL,IAAIG,IAAJ,CAASG,IAAvC,CAAb,EAA4D;AAC1D,WAAOJ,MAAP;AACD;AACD,MAAIK,IAAIC,mBAAmB,qBAAnB,CAAR;AACAR,MAAIS,GAAJ,CAAQC,KAAR,CAAc,+BAAd;AACA,SAAOT,IAAIU,QAAJ,CAAa,SAAb,CAAP;AACD,CATD;AAUAZ,UAAUa,MAAV,GAAmBd,QAAQ,gBAAR,CAAnB;AACAe,OAAOC,OAAP,GAAiB,EAACf,oBAAD,EAAjB","file":"authorization.js","sourcesContent":["'use strict'\nconst _ = require('lodash')\nconst authorize = (req, res, next) => {\n  var user = req.user\n  req.called = true\n  if (user && (_.includes(['admin', 'user'], req.user.role))) {\n    return next()\n  }\n  var m = encodeURIComponent('The page not found.')\n  req.log.error('request for protected routes.')\n  return res.redirect('/logout')\n}\nauthorize.unless = require('express-unless')\nmodule.exports = {authorize}\n"]}