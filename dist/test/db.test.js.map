{"version":3,"sources":["../../test/db.test.js"],"names":["process","env","NODE_ENV","require","config","faker","Whitelist","User","uuid","DateTime","confirmEmailToken","verifyToken","test","done","dt","local","u","email","internet","firstName","name","lastName","pwd","save","error","doc","expect","toBe","console","log","toObject"],"mappings":"AAAA;;AACAA,QAAQC,GAAR,CAAYC,QAAZ,GAAuB,aAAvB;AACAC,QAAQ,QAAR,EAAkBC,MAAlB;AACA,IAAMC,QAAQF,QAAQ,OAAR,CAAd;AACAA,QAAQ,WAAR,EAAqB,YAAM,CAAE,CAA7B;;eAC0BA,QAAQ,cAAR,C;IAAnBG,S,YAAAA,S;IAAWC,I,YAAAA,I;;AAClB,IAAMC,OAAOL,QAAQ,MAAR,CAAb;;gBACmBA,QAAQ,OAAR,C;IAAZM,Q,aAAAA,Q;;gBACkCN,QAAQ,qBAAR,C;IAAlCO,iB,aAAAA,iB;IAAmBC,W,aAAAA,W;;AAE1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAC,KAAK,MAAL,EAAa,UAACC,IAAD,EAAU;AACrB,MAAIC,KAAKL,SAASM,KAAT,EAAT;;AAEA,MAAIC,IAAI,IAAIT,IAAJ,CAAS;AACfU,WAAOZ,MAAMa,QAAN,CAAeD,KAAf,EADQ;AAEfE,eAAW,UAAUd,MAAMe,IAAN,CAAWD,SAAX,EAFN;AAGfE,cAAU,UAAUhB,MAAMe,IAAN,CAAWC,QAAX,EAHL;AAIfC,SAAK;AAJU,GAAT,CAAR;;AAOAN,IAAEO,IAAF,CAAO,UAACC,KAAD,EAAQC,GAAR,EAAgB;AACrBC,WAAOF,KAAP,EAAcG,IAAd,CAAmB,IAAnB;AACAC,YAAQC,GAAR,CAAYJ,IAAIK,QAAJ,EAAZ;AACAjB;AAED,GALD;AAMD,CAhBD","file":"db.test.js","sourcesContent":["'use strict'\nprocess.env.NODE_ENV = 'development'\nrequire('dotenv').config()\nconst faker = require('faker')\nrequire('../lib/db')(() => {})\nconst {Whitelist, User} = require('../lib/model')\nconst uuid = require('uuid')\nconst {DateTime} = require('luxon')\nconst {confirmEmailToken, verifyToken} = require('../lib/jsonwebtoken')\n\n// let db = DB()\n// test('whitelist', (done) => {\n//   let dt = DateTime.local()\n//\n//   var wl = new Whitelist({\n//     email: faker.internet.email(),\n//     firstName: 'fake-' + faker.name.firstName(),\n//     lastName: 'fake-' + faker.name.lastName(),\n//     ip: faker.internet.ip(),\n//     purchaseAmount: '1000-5000',\n//     cryptoType: 'ETH',\n//     country: 'US',\n//     token: {\n//       jwt: uuid.v4(),\n//       // blackListed: {type: Boolean, default: false},\n//       // revoked: {type: Boolean, default: false}\n//     },\n//     timeZone: {\n//       ts: dt.ts,\n//       zoneName: dt.zoneName,\n//       offset: dt.offset\n//     }\n//   })\n//\n//   wl.save((error, doc) => {\n//     expect(error).toBe(null)\n//     // expect(doc).toBeGreaterThan(0)\n//     confirmEmailToken(doc.id)\n//     .then((token) => {\n//       let updates = {$set: {'token.jwt': token}}\n//\n//       Whitelist.update({_id: doc.id}, updates, {new: true}, (err, doc) => {\n//         expect(err).toBeNull()\n//         console.log(doc.toObject())\n//         done()\n//       })\n//     }).catch((err) => {\n//       expect(err).toBeNull()\n//       done()\n//     })\n//   })\n// })\n\ntest('user', (done) => {\n  let dt = DateTime.local()\n\n  var u = new User({\n    email: faker.internet.email(),\n    firstName: 'fake-' + faker.name.firstName(),\n    lastName: 'fake-' + faker.name.lastName(),\n    pwd: '12345567'\n  })\n\n  u.save((error, doc) => {\n    expect(error).toBe(null)\n    console.log(doc.toObject())\n    done()\n\n  })\n})\n"]}